{"version":3,"file":"commonHelpers.js","sources":["../src/js/books-api.js","../src/js/category-sidebar.js","../src/js/content-home.js","../src/js/modal-window.js","../src/js/scroll-up.js"],"sourcesContent":["const BASE_URL = 'https://books-backend.p.goit.global/books';\n\nconst API_OPTIONS = {\n  list: 'category-list',\n  top: 'top-books',\n  category: 'category?category=',\n};\n\nasync function fetchBookList(option, select = '') {\n  try {\n    const response = await fetch(`${BASE_URL}/${option}${select}`);\n    const list = await response.json();\n    console.log(\n      `data retrieving was succesfull: ${response.status} - ${response.statusText}`\n    );\n    return list;\n  } catch (error) {\n    console.log(`An error occurred: ${error.message}`);\n    alert('An error occurred');\n  }\n}\n\nasync function fetchBookById(bookId) {\n  try {\n    const response = await fetch(`${BASE_URL}/${bookId}`);\n    const book = await response.json();\n    console.log(\n      `data retrieving was succesfull: ${response.status} - ${response.statusText}`\n    );\n    return book;\n  } catch (error) {\n    console.log(`An error occurred: ${error.message}`);\n    alert('An error occurred');\n  }\n}\n\nexport default { API_OPTIONS, fetchBookList, fetchBookById };\n","import api from './books-api';\n\nconst ctgList = document.querySelector('.ctg-list');\n\napi.fetchBookList(api.API_OPTIONS.list).then(response => {\n  const markup = response\n    .map(\n      ({\n        list_name,\n      }) => `<li class=\"ctg-item js-ctg-item \" data-ctg-name = ${list_name}>${list_name}\n          </li>`\n    )\n    .join('');\n\n  ctgList.insertAdjacentHTML('beforeend', markup);\n});\n","import api from './books-api';\nimport markup from './markup';\nimport getRefs from './refs';\n\nconst refs = getRefs();\n\napi.fetchBookList(api.API_OPTIONS.top).then(markup.renderTopBooks);\n\nfunction highlightMenuActiveCategory(event) {\n  [...refs.ctgList.children].forEach(li =>\n    li.classList.remove('ctg-item-active')\n  );\n  if (refs.ctgList.contains(event.target)) {\n    event.target.classList.add('ctg-item-active');\n  } else {\n    const match = [...refs.ctgList.children].find(\n      li => li.textContent.trim() === event.target.dataset.category\n    );\n    match.classList.add('ctg-item-active');\n  }\n}\n\nfunction showSelectedCategoryBooks(event) {\n  const selectedCategory = event.target.childNodes[0].data;\n  highlightMenuActiveCategory(event);\n  if (selectedCategory !== 'All categories') {\n    api\n      .fetchBookList(api.API_OPTIONS.category, selectedCategory)\n      .then(markup.renderCategoryBooks);\n  } else {\n    api.fetchBookList(api.API_OPTIONS.top).then(markup.renderTopBooks);\n  }\n}\n\nfunction showMoreCategoryBooks(event) {\n  if (!event.target.classList.contains('top-books-button')) {\n    return;\n  }\n  const category = event.target.dataset.category;\n  highlightMenuActiveCategory(event);\n  api\n    .fetchBookList(api.API_OPTIONS.category, category)\n    .then(markup.renderCategoryBooks);\n}\n\nrefs.ctgList.addEventListener('click', showSelectedCategoryBooks);\nrefs.bookCollectionWrapper.addEventListener('click', showMoreCategoryBooks);\n","import icon from '../images/icons.svg';\nimport amazon from '../images/modal-window/amazon.png';\nimport amazon2x from '../images/modal-window/amazon@2x.png';\nimport applebooks from '../images/modal-window/applebooks.png';\nimport applebooks2x from '../images/modal-window/applebooks@2x.png';\nimport booksApi from './books-api';\n\nconst KEY_LOCAL_STORAGE = 'shoppingList';\nconst bookCollectionWrapper = document.querySelector(\".book-collection-wrapper\");\nlet backdrop;\nlet modalWrapper;\nlet addBtn;\n\nbookCollectionWrapper.addEventListener('click', async (event) => {\n    // Перевіряємо, чи клікнуто на .book-link або на його дочірніх елементах\n    const bookElement = event.target.closest('.book-link');\n\n    if (bookElement) {\n        event.preventDefault();\n        const bookId = bookElement.dataset.id;\n        // потрібен датасет (дописала локально у markup.js (строка 11 та 43) після href=\"\" data-id=\"${book._id}\">)\n        try {\n            const book = await booksApi.fetchBookById(bookId);\n            markupModalWindow(book);\n        } catch (error) {\n            console.error('Error fetching book details:', error);\n        }\n    }\n});\n\nfunction markupModalWindow(book) {\n    //console.log('Opening modal with book details:', book);\n    // елементи для темного фону та модального вікна\n    backdrop = document.createElement('div');\n    modalWrapper = document.createElement('div');\n    // Додала класи та стилі\n    backdrop.classList.add('backdrop', 'visually-hidden');\n    modalWrapper.classList.add('modal-wrapper', 'visually-hidden');\n\n    modalWrapper.innerHTML= \n        `<div class=\"book-modal\">\n            <img src=\"${book.book_image}\" alt=\"${book.title}\" class=\"book-modal-img\"/>\n            <div class=\"book-modal-details\">\n                <h2 class=\"book-modal-title\">${book.title}</h2>\n                <h3 class=\"book-modal-author\">${book.author}</h3>\n                <p class=\"book-modal-desc\">${book.description}</p>\n                <ul class=\"icon-book-modal-list\">\n                    <li>\n                        <a href=\"${book.buy_links[0].url}\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">\n                            <img class=\"icon-book-modal-amazon\" srcset=\"${amazon} 1x, ${amazon2x} 2x\" src=\"${amazon}\" alt=\"Amazon\" loading=\"lazy\"/>\n                        </a>\n                    </li>\n                    <li>\n                        <a href=\"${book.buy_links[1].url}\" rel=\"noopener noreferrer nofollow\" target=\"_blank\">\n                            <img class=\"icon-book-modal-ibooks\" srcset=\"${applebooks} 1x, ${applebooks2x} 2x\" src=\"${applebooks}\" alt=\"Apple books\" loading=\"lazy\"/>\n                        </a>\n                    </li>\n                </ul>\n            </div>\n            <button class='book-modal-btn js-add' id='js-book-modal-btn'>Add to shopping list</button>\n            <p class='book-modal-buy'>Congratulations! You have added the book to the shopping list. To delete, press the button “Remove from the shopping list”.</p>\n            <button class='book-modal-close' id='js-book-modal-btn-close'>\n                <svg class='icon-book-modal-close'><use href='${icon}#x-close'></use></svg>\n            </button>\n        </div>`;\n        // Вставляємо створені елементи в тіло документу\n        document.body.appendChild(backdrop);\n        document.body.appendChild(modalWrapper);\n        // Перевірте, чи вже існує екземпляр lightbox\n        backdrop.classList.remove('visually-hidden');\n        modalWrapper.classList.remove('visually-hidden');\n        //Oбробник для закриття модального вікна\n        const closeBtn = document.querySelector('#js-book-modal-btn-close');\n        console.log('вбийте мене', closeBtn)\n        if (closeBtn) {\n            closeBtn.addEventListener('click', () => {\n                closeModaWindow();\n            });\n        }\n\n        addBtn = document.querySelector('#js-book-modal-btn');\n        console.log('це капець', addBtn);\n        if (addBtn.c) {\n            addBtn.addEventListener('click', () => {\n                //toggleShoppingList(book);\n            });\n        }\n\n        toggleScrollLock(true); // блокування прокрутки\n\n        document.addEventListener('keydown', handleKeyPress);\n        backdrop.addEventListener('click', handleBackdropClick);\n}\n\nfunction toggleScrollLock(lock) {\n    if (lock) {\n        document.body.classList.add('modal-open');\n    } else {\n        document.body.classList.remove('modal-open');\n    }\n}\n// Oбробник для кнопки Add to shopping list     \nfunction handleKeyPress(event) {\n    if (event.key === 'Escape') {\n        closeModaWindow();\n    }\n}\n    \nfunction handleBackdropClick(event) {\n    if (event.target === backdrop) {\n            closeModaWindow();\n    }\n}\n    \nfunction closeModaWindow() {\n    backdrop.classList.add('visually-hidden');\n    modalWrapper.classList.add('visually-hidden');\n    toggleScrollLock(false); // розблокування прокрутки\n    document.removeEventListener('keydown', handleKeyPress);\n    backdrop.removeEventListener('click', handleBackdropClick);\n\n    // Видаляємо слухача події з кнопки\n    if (addBtn) {\n        addBtn.removeEventListener('click', handleAddBtnClick);\n    }\n}\n\nfunction handleAddBtnClick() {\n    toggleShoppingList(book);\n    // Видаляємо слухача події з кнопки після кліку\n    if (addBtn) {\n        addBtn.removeEventListener('click', handleAddBtnClick);\n    }\n}\n\n//Oновлення списку покупок, додавання або видалення книги залежно від її наявності у списку.\nfunction toggleShoppingList(book) {\n    const shoppingList = getFromLocalStorage();\n    const bookIndex = shoppingList.findIndex(item => item.id === book._id);\n\n    if (bookIndex !== -1) {\n        // Книга вже у shopping list, прибираємо книгу\n        shoppingList.splice(bookIndex, 1);\n    } else {\n        // Додаємо книгу у shopping list\n        shoppingList.push({\n            id: book._id,\n            image: book.book_image,\n            title: book.title,\n            author: book.author,\n            description: book.description,\n            buy_links: book.buy_links,\n            // Перевірити за макетом що ще додати\n        });\n    }\n    // Зберегаємо оновлений shopping list у localStorage\n    saveToLocalStorage(shoppingList);\n    updateTextBtn(book);\n};\n\n\nfunction getFromLocalStorage() {\n    const shoppingListString = localStorage.getItem(KEY_LOCAL_STORAGE);\n    return shoppingListString ? JSON.parse(shoppingListString) : [];\n};\n\nfunction saveToLocalStorage(shoppingList) {\n    localStorage.setItem(KEY_LOCAL_STORAGE, JSON.stringify(shoppingList));\n};\n\n\nfunction updateTextBtn(book) {\n    const textBtn = document.querySelector('#js-book-modal-btn');\n    console.log('updateTextBtn addBtn', textBtn);\n    const buyMessage = document.querySelector('.book-modal-buy');\n    if (textBtn && buyMessage) {\n        const isInShoppingList = isInShoppingList(book);\n        //console.log('updateTextBtn isInShoppingList', isInShoppingList);\n        if (isInShoppingList) {\n            textBtn.textContent = 'Remove from the shopping list';\n            buyMessage.style.display = 'block'; // Відображаємо повідомлення\n        } else {\n            textBtn.textContent = 'Add to shopping list';\n            buyMessage.style.display = 'none'; // Приховуємо повідомлення\n        }\n    }\n};\n\nfunction isInShoppingList(book) {\n    const shoppingList = getFromLocalStorage();\n    return shoppingList.some(item => item.id === book._id);\n}\n\n","const goTopBtn = document.querySelector(\".back-to-top\");\n\nwindow.addEventListener(\"scroll\", trackScroll);\ngoTopBtn.addEventListener(\"click\", goTop);\n\nfunction trackScroll() {\n\n  const scrolled = window.pageYOffset;\n  const coords = document.documentElement.clientHeight;\n\n  if (scrolled > coords) {\n    goTopBtn.classList.add(\"back-to-top--show\");\n  } else {\n    goTopBtn.classList.remove(\"back-to-top--show\");\n  }\n}\n\nfunction goTop() {\n\n  if (window.pageYOffset > 0) {\n    window.scrollBy(0, -25);\n    setTimeout(goTop, 0); \n  }\n}"],"names":["BASE_URL","API_OPTIONS","fetchBookList","option","select","response","list","error","fetchBookById","bookId","book","booksApi","ctgList","api","markup","list_name","refs","getRefs","highlightMenuActiveCategory","event","li","showSelectedCategoryBooks","selectedCategory","showMoreCategoryBooks","category","KEY_LOCAL_STORAGE","bookCollectionWrapper","backdrop","modalWrapper","addBtn","bookElement","markupModalWindow","amazon","amazon2x","applebooks","applebooks2x","icon","closeBtn","closeModaWindow","toggleScrollLock","handleKeyPress","handleBackdropClick","lock","handleAddBtnClick","toggleShoppingList","shoppingList","getFromLocalStorage","bookIndex","item","saveToLocalStorage","updateTextBtn","shoppingListString","textBtn","buyMessage","isInShoppingList","goTopBtn","trackScroll","goTop","scrolled","coords"],"mappings":"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"}