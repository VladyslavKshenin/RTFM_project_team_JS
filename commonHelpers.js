import{g as w,m as r,a as g,b as B,c as m,d as S,l as $}from"./assets/applebooks@2x-b02de412.js";const p="https://books-backend.p.goit.global/books",E={list:"category-list",top:"top-books",category:"category?category="};async function A(o,t=""){try{const e=await fetch(`${p}/${o}${t}`),n=await e.json();return console.log(`data retrieving was succesfull: ${e.status} - ${e.statusText}`),n}catch(e){console.log(`An error occurred: ${e.message}`),alert("An error occurred")}}async function I(o){try{const t=await fetch(`${p}/${o}`),e=await t.json();return console.log(`data retrieving was succesfull: ${t.status} - ${t.statusText}`),e}catch(t){console.log(`An error occurred: ${t.message}`),alert("An error occurred")}}const s={API_OPTIONS:E,fetchBookList:A,fetchBookById:I},T=document.querySelector(".ctg-list");s.fetchBookList(s.API_OPTIONS.list).then(o=>{const t=o.map(({list_name:e})=>`<li class="ctg-item js-ctg-item " data-ctg-name = ${e}>${e}
          </li>`).join("");T.insertAdjacentHTML("beforeend",t)});const l=w();s.fetchBookList(s.API_OPTIONS.top).then(r.renderTopBooks);function k(o){[...l.ctgList.children].forEach(t=>t.classList.remove("ctg-item-active")),l.ctgList.contains(o.target)?o.target.classList.add("ctg-item-active"):[...l.ctgList.children].find(e=>e.textContent.trim()===o.target.dataset.category).classList.add("ctg-item-active")}function O(o){const t=o.target.childNodes[0].data;k(o),t!=="All categories"?s.fetchBookList(s.API_OPTIONS.category,t).then(r.renderCategoryBooks):s.fetchBookList(s.API_OPTIONS.top).then(r.renderTopBooks)}function _(o){if(!o.target.classList.contains("top-books-button"))return;const t=o.target.dataset.category;k(o),s.fetchBookList(s.API_OPTIONS.category,t).then(r.renderCategoryBooks)}l.ctgList.addEventListener("click",O);l.bookCollectionWrapper.addEventListener("click",_);const h="shoppingList",x=document.querySelector(".book-collection-wrapper");let c,i,a;x.addEventListener("click",async o=>{const t=o.target.closest(".book-link");if(t){o.preventDefault();const e=t.dataset.id;try{const n=await s.fetchBookById(e);C(n)}catch(n){console.error("Error fetching book details:",n)}}});function C(o){c=document.createElement("div"),i=document.createElement("div"),c.classList.add("backdrop","visually-hidden"),i.classList.add("modal-wrapper","visually-hidden"),i.innerHTML=`<div class="book-modal">
            <img src="${o.book_image}" alt="${o.title}" class="book-modal-img"/>
            <div class="book-modal-details">
                <h2 class="book-modal-title">${o.title}</h2>
                <h3 class="book-modal-author">${o.author}</h3>
                <p class="book-modal-desc">${o.description}</p>
                <ul class="icon-book-modal-list">
                    <li>
                        <a href="${o.buy_links[0].url}" rel="noopener noreferrer nofollow" target="_blank">
                            <img class="icon-book-modal-amazon" srcset="${g} 1x, ${B} 2x" src="${g}" alt="Amazon" loading="lazy"/>
                        </a>
                    </li>
                    <li>
                        <a href="${o.buy_links[1].url}" rel="noopener noreferrer nofollow" target="_blank">
                            <img class="icon-book-modal-ibooks" srcset="${m} 1x, ${S} 2x" src="${m}" alt="Apple books" loading="lazy"/>
                        </a>
                    </li>
                </ul>
            </div>
            <button class='book-modal-btn js-add' id='js-book-modal-btn'>Add to shopping list</button>
            <p class='book-modal-buy'>Congratulations! You have added the book to the shopping list. To delete, press the button “Remove from the shopping list”.</p>
            <button class='book-modal-close' id='js-book-modal-btn-close'>
                <svg class='icon-book-modal-close'><use href='${$}#x-close'></use></svg>
            </button>
        </div>`,document.body.appendChild(c),document.body.appendChild(i),c.classList.remove("visually-hidden"),i.classList.remove("visually-hidden");const t=document.querySelector("#js-book-modal-btn-close");console.log("вбийте мене",t),t&&t.addEventListener("click",()=>{u()}),a=document.querySelector("#js-book-modal-btn"),console.log("це капець",a),a.c&&a.addEventListener("click",()=>{}),f(!0),document.addEventListener("keydown",b),c.addEventListener("click",y)}function f(o){o?document.body.classList.add("modal-open"):document.body.classList.remove("modal-open")}function b(o){o.key==="Escape"&&u()}function y(o){o.target===c&&u()}function u(){c.classList.add("visually-hidden"),i.classList.add("visually-hidden"),f(!1),document.removeEventListener("keydown",b),c.removeEventListener("click",y),a&&a.removeEventListener("click",L)}function L(){P(book),a&&a.removeEventListener("click",L)}function P(o){const t=j(),e=t.findIndex(n=>n.id===o._id);e!==-1?t.splice(e,1):t.push({id:o._id,image:o.book_image,title:o.title,author:o.author,description:o.description,buy_links:o.buy_links}),N(t),q(o)}function j(){const o=localStorage.getItem(h);return o?JSON.parse(o):[]}function N(o){localStorage.setItem(h,JSON.stringify(o))}function q(o){const t=document.querySelector("#js-book-modal-btn");console.log("updateTextBtn addBtn",t);const e=document.querySelector(".book-modal-buy");if(t&&e){const n=n(o);n?(t.textContent="Remove from the shopping list",e.style.display="block"):(t.textContent="Add to shopping list",e.style.display="none")}}const d=document.querySelector(".back-to-top");window.addEventListener("scroll",M);d.addEventListener("click",v);function M(){const o=window.pageYOffset,t=document.documentElement.clientHeight;o>t?d.classList.add("back-to-top--show"):d.classList.remove("back-to-top--show")}function v(){window.pageYOffset>0&&(window.scrollBy(0,-25),setTimeout(v,0))}
//# sourceMappingURL=commonHelpers.js.map
